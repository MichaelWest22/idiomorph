<!DOCTYPE html>
<html>
<head>
    <title>Test keepInputValues Feature</title>
    <script src="src/idiomorph.js"></script>
</head>
<body>
    <h1>Test keepInputValues Feature</h1>
    
    <div id="test-container">
        <input type="text" id="test-input" value="initial">
        <textarea id="test-textarea">initial text</textarea>
        <input type="checkbox" id="test-checkbox" checked>
    </div>
    
    <button onclick="testWithoutKeepInputValues()">Test WITHOUT keepInputValues</button>
    <button onclick="testWithKeepInputValues()">Test WITH keepInputValues</button>
    <button onclick="resetValues()">Reset Values</button>
    
    <div id="results"></div>
    
    <script>
        function resetValues() {
            document.getElementById('test-input').value = 'user typed value';
            document.getElementById('test-textarea').value = 'user typed textarea content';
            document.getElementById('test-checkbox').checked = false;
            document.getElementById('results').innerHTML = '<p>Values reset. Input has "user typed value", textarea has "user typed textarea content", checkbox is unchecked.</p>';
        }
        
        function testWithoutKeepInputValues() {
            const container = document.getElementById('test-container');
            const newContent = `
                <input type="text" id="test-input" value="new value from server">
                <textarea id="test-textarea">new textarea from server</textarea>
                <input type="checkbox" id="test-checkbox">
            `;
            
            Idiomorph.morph(container, newContent, { morphStyle: 'innerHTML' });
            
            const input = document.getElementById('test-input');
            const textarea = document.getElementById('test-textarea');
            const checkbox = document.getElementById('test-checkbox');
            
            document.getElementById('results').innerHTML = `
                <h3>Test WITHOUT keepInputValues:</h3>
                <p>Input value: "${input.value}" (should be "new value from server")</p>
                <p>Textarea value: "${textarea.value}" (should be "new textarea from server")</p>
                <p>Checkbox checked: ${checkbox.checked} (should be false)</p>
            `;
        }
        
        function testWithKeepInputValues() {
            const container = document.getElementById('test-container');
            const newContent = `
                <input type="text" id="test-input" value="new value from server">
                <textarea id="test-textarea">new textarea from server</textarea>
                <input type="checkbox" id="test-checkbox">
            `;
            
            Idiomorph.morph(container, newContent, { 
                morphStyle: 'innerHTML',
                keepInputValues: true 
            });
            
            const input = document.getElementById('test-input');
            const textarea = document.getElementById('test-textarea');
            const checkbox = document.getElementById('test-checkbox');
            
            document.getElementById('results').innerHTML = `
                <h3>Test WITH keepInputValues:</h3>
                <p>Input value: "${input.value}" (should be "user typed value")</p>
                <p>Textarea value: "${textarea.value}" (should be "user typed textarea content")</p>
                <p>Checkbox checked: ${checkbox.checked} (should be false - user state preserved)</p>
            `;
        }
        
        // Initialize with user values
        resetValues();
    </script>
</body>
</html>